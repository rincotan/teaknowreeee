<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>はぴば</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }
    .page {
      display: none;
    }
    .active {
      display: block;
    }
    .input-frame {
      position: relative;
      display: inline-block;
      width: 300px;
      height: 200px;
      margin: 20px auto;
    }
    .input-frame img {
      width: 100%;
      height: 100%;
      display: block;
    }
    .input-frame input {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70%;
      height: 40px;
      font-size: 18px;
      text-align: center;
      border: none;
      background: transparent;
      outline: none;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
    }
    .media-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .media-container video,
    .media-container img {
      width: 200px;
      height: auto;
    }
    .back-button {
      margin-top: 30px;
      display: block;
    }
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #fce4ec; /* 好きな色に変更OK */
      padding: 15px 0;
      text-align: center;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .header h1 {
      margin: 0;
      font-size: 24px;
    }

    /* コンテンツ全体に上の余白を追加して被らないようにする */
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 80px 20px 20px; /* ← 上に80pxの余白追加 */
    }
    .video-wrapper {
      position: relative;
      display: inline-block;
      border: 4px solid transparent;
      border-radius: 8px;
      overflow: hidden;
    }

    .video-wrapper video {
      width: 200px;
      height: auto;
      display: block;
    }

    /* 枠の色 */
    .video-wrapper.red {
      border-color: red;
    }
    .video-wrapper.blue {
      border-color: blue;
    }
    .video-wrapper.yellow {
      border-color: gold;
    }

    /* ラベルのスタイル */
    .video-wrapper.label .label-text {
      position: absolute;
      top: 4px;
      left: 6px;
      background-color: rgba(255, 255, 255, 0.8);
      color: black;
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 18px;
      z-index: 2;
      pointer-events: none; /* クリックを動画に通す */
    }

  </style>
</head>
<body>

  <!-- STEP1 -->
  <div id="step1" class="page active">
    <div class="header"><h1>STEP1</h1></div>
    <div class="input-frame">
      <img src="frame.png" alt="入力枠">
      <input type="text" id="inputStep1" placeholder="ここに入力してください">
    </div>
    <br>
    <button onclick="checkStep1()">次へ</button>
  </div>

  <!-- STEP2 -->
  <div id="step2" class="page">
    <div class="header"><h1>STEP2</h1></div>
    <h2><strong style="color: red;">赤</strong>＝<strong style="color: blue;">赤</strong>で3セットつくり、赤のペア読め</h2>
    <img id="puzzleImageStep2" src="step2_image.png" alt="謎解き画像">
    <div class="media-container">
      <!-- 色枠付き3本 -->
      <div class="video-wrapper red"><video controls src="video1.mp4"></video></div>
      <div class="video-wrapper blue"><video controls src="video2.mp4"></video></div>
      <div class="video-wrapper yellow"><video controls src="video3.mp4"></video></div>

      <!-- ラベル付き3本 -->
      <div class="video-wrapper label"><span class="label-text">①</span><video controls src="video4.mp4"></video></div>
      <div class="video-wrapper label"><span class="label-text">②</span><video controls src="video5.mp4"></video></div>
      <div class="video-wrapper label"><span class="label-text">③</span><video controls src="video6.mp4"></video></div>
    </div>
    <div class="input-frame" style="margin-top: 30px;">
      <img src="frame.png" alt="入力枠">
      <input type="text" id="inputStep2" placeholder="ここに入力してください">
    </div>
    <br>
    <button onclick="checkStep2()">次へ</button>
    <button class="back-button" onclick="goToStep('step1')">← 戻る</button>
  </div>

  <!-- STEP3 -->
  <div id="step3" class="page">
    <div class="header"><h1>STEP3</h1></div>

    <div style="display: flex; flex-direction: column; align-items: center;">
      <img id="puzzleImageStep3" src="step3_image.png" alt="謎解き画像" style="margin-top: 10px; max-width: 30%; height: auto;">

      <h1>⇩</h1>
      <h2>赤よめ</h2>

      <div class="input-frame" style="margin-top: 30px;">
        <img src="frame.png" alt="入力枠">
        <input type="text" id="inputStep3" placeholder="ここに入力してください">
      </div>
    </div>
    <br>
      <button onclick="checkStep3()">次へ</button>
      <button class="back-button" onclick="goToStep('step2')">← 戻る</button>
  </div>



  <!-- LASTSTEP -->
  <div id="laststep" class="page">
    <div class="header"><h1>LAST</h1></div>
    <p>「今まで使ってきた枠の画像」すべてに触れろ</p>
    <div class="media-container">
      <img src="frame1.png" class="touch-image" onclick="markImageTouched(0)" alt="frame1">
      <img src="frame2.png" class="touch-image" onclick="markImageTouched(1)" alt="frame2">
      <img src="frame3.png" class="touch-image" onclick="markImageTouched(2)" alt="frame3">
      <img src="frame4.png" class="touch-image" onclick="markImageTouched(3)" alt="frame4">
    </div>
  </div>

  <!-- LASTSTEP - ANSWER -->
  <div id="lastanswer" class="page">
    <div class="header"><h1>LAST</h1></div>
    <p>○○にしてやり直せ</p>
    <div style="margin-top: 30px;">
      <input type="text" id="inputLast" placeholder="ここに入力してください" style="width: 70%; height: 40px; font-size: 18px; text-align: center;">
    </div>

    <br>
    <button onclick="checkLast()">送信</button>
  </div>

  <!-- FINAL VIDEO PAGE -->
  <div id="videoend" class="page">
    <div class="header"><h1>HAPPY BIRTHDAY!!</h1></div>
    <video controls src="final_video.mp4" style="width: 90%; max-width: 600px;"></video>
    <div style="margin-top: 30px;">
      <button onclick="showStep('step1')">STEP1へ</button>
      <button onclick="showStep('step2')">STEP2へ</button>
      <button onclick="showStep('step3')">STEP3へ</button>
      <button onclick="showStep('laststep')">LASTSTEPへ</button>
    </div>
  </div>




  <script>
    let step1Cleared = false;
    let step2Cleared = false;
    let step3Cleared = false;

    let touchedImages = [false, false, false, false];

    function showStep(stepId) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.getElementById(stepId).classList.add("active");
    }

    function checkStep1() {
      const input = document.getElementById("inputStep1").value.trim();
      if (input === "ひろとん") {
        step1Cleared = true;
        showStep("step2");
      } else {
        alert("答えが違います。");
      }
    }

    function checkStep2() {
      const input = document.getElementById("inputStep2").value.trim();
      if (input === "あさり") {
        step2Cleared = true;
        showStep("step3");
      } else {
        alert("答えが違います。");
      }
    }

    function checkStep3() {
      const input = document.getElementById("inputStep3").value.trim();
      if (input === "えにぐま") {
        step3Cleared = true;
        showStep("laststep");
      } else {
        alert("答えが違います。");
      }
    }

    function checkLast() {
      const input = document.getElementById("inputLast").value.trim();
      if (input === "おせち") {
        showStep("videoend");
      } else {
        alert("答えが違います。");
      }
    }

    function markImageTouched(index) {
      touchedImages[index] = true;
      document.getElementsByClassName("touch-image")[index].style.opacity = 0.5;

      if (touchedImages.every(t => t)) {
        setTimeout(() => showStep("lastanswer"), 500);
      }
    }

    function goToStep(stepId) {
      if (stepId === "step1" && step1Cleared) {
        showStep("step1");
      } else if (stepId === "step2" && step2Cleared) {
        showStep("step2");
      } else if (stepId === "step3" && step3Cleared) {
        showStep("step3");
      } else {
        alert("このステップにはまだ戻れません。");
      }
    }
  </script>

</body>
</html>
